(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{386:function(t,s,a){"use strict";a.r(s);var n=a(1),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"slides的二种动画思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#slides的二种动画思路","aria-hidden":"true"}},[t._v("#")]),t._v(" slides的二种动画思路")]),t._v(" "),a("h2",{attrs:{id:"思路1：-dom操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#思路1：-dom操作","aria-hidden":"true"}},[t._v("#")]),t._v(" 思路1： DOM操作")]),t._v(" "),a("p",[t._v("通过操作一个包含每一个item的很长的dom的左右平移，控制视口大小来实现轮播")]),t._v(" "),a("p",[t._v("通过在第一项前复制最后一张图，在最后一项后复制第一张图，来实现无缝轮播")]),t._v(" "),a("p",[t._v("这样的好处是比较容易理解，也是常用的做法。缺点是在vue中操作dom，没法充分利用vue的便利")]),t._v(" "),a("h2",{attrs:{id:"思路2：-单项数据流"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#思路2：-单项数据流","aria-hidden":"true"}},[t._v("#")]),t._v(" 思路2： 单项数据流")]),t._v(" "),a("p",[t._v("vue组件单项数据流有一个特点就是，api往往会设计成.sync的形式。")]),t._v(" "),a("p",[t._v("设置用户当前选中的图，是selected。")]),t._v(" "),a("ul",[a("li",[t._v("当selected的值变化时，就会发生动画")]),t._v(" "),a("li",[t._v("当用户点击前进、后退时，我们通过emit触发selected的变化")]),t._v(" "),a("li",[t._v("当用户点击1/2/3/4时，我们通过emit触发selected的变化")]),t._v(" "),a("li",[t._v("当用户自动轮播时，我们通过emit触发selected的变化")])]),t._v(" "),a("p",[t._v("而第一步是如何实现的呢？ 当selected的值变化时，就会发生动画")]),t._v(" "),a("p",[t._v("就是利用vue里的"),a("code",[t._v("<transition></transition>")])]),t._v(" "),a("p",[t._v("selected的变化会控制当前item的显示和隐藏，此时会触发动画")]),t._v(" "),a("p",[t._v("例如:")]),t._v(" "),a("p",[t._v("这里的动画有2个小技巧")]),t._v(" "),a("ul",[a("li",[a("code",[t._v(".slide-leave-active")]),t._v("时我们设置它为"),a("code",[t._v("absolute")]),t._v(",也就是离开的那个item不占位置")]),t._v(" "),a("li",[t._v("利用reverse类名，来实现反向轮播动画")])]),t._v(" "),a("div",{staticClass:"language-css extra-class"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{attrs:{class:"token selector"}},[t._v(".slide-leave-active")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v("transition")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" all 1s"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v("position")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" absolute"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // 离开的那个是绝对定位\n  "),a("span",{attrs:{class:"token property"}},[t._v("width")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 100%"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v("height")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 100%"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v("left")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v("top")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{attrs:{class:"token selector"}},[t._v(".slide-enter-active")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v("transition")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" all 1s"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token selector"}},[t._v(".slide-enter")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v("transform")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("translateX")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("100%"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token selector"}},[t._v(".slide-leave-to")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v("transform")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("translateX")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("-100%"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{attrs:{class:"token selector"}},[t._v(".slide-enter.reverse")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v("transform")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("translateX")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("-100%"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token selector"}},[t._v(".slide-leave-to.reverse")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v("transform")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("translateX")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("100%"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"写单元测试时遇到的一些小问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#写单元测试时遇到的一些小问题","aria-hidden":"true"}},[t._v("#")]),t._v(" 写单元测试时遇到的一些小问题")]),t._v(" "),a("blockquote",[a("p",[t._v("1.slot如何传递子组件，子组件的props和slot又该如何传递")])]),t._v(" "),a("p",[t._v("由于这个组件是要用到slides和slides-item。")]),t._v(" "),a("ul",[a("li",[t._v("slot如果是一个组件，该如何传递进去？")]),t._v(" "),a("li",[t._v("就算可以传递组件，那么组件里props和slot又如何传递呢？")])]),t._v(" "),a("p",[t._v("结合文档和一些github上的示例，找到了答案")]),t._v(" "),a("p",[t._v("https://vue-test-utils.vuejs.org/zh/api/options.html#slots")]),t._v(" "),a("p",[t._v("你需要先注册子组件，只有用模板字符串的语法，正常往子组件里传递prop和slot就成。")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Vue "),a("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"vue"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nVue"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("component")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"l-slides-item"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SlidesItem"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nslots"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token template-string"}},[a("span",{attrs:{class:"token string"}},[t._v('`\n        <l-slides-item name="1">\n            <div class="box1">1</div>\n        </l-slides-item>\n        <l-slides-item name="2">\n            <div class="box2">2</div>\n        </l-slides-item>\n        <l-slides-item name="3">\n            <div class="box3">3</div>\n        </l-slides-item>\n        `')])]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("2.如何模拟.sync？")])]),t._v(" "),a("p",[t._v('因为 :selected.sync="selected",等于是监听了update:selected="selected = $event"')]),t._v(" "),a("p",[t._v("但是在写单元测试时，没法写这种.sync语法呀")]),t._v(" "),a("p",[t._v("经过几番尝试，发现是可以利用listeners设置实例的"),a("code",[t._v("$listeners")]),t._v("对象")]),t._v(" "),a("p",[t._v("在事件中，结合setProps可以设置vm的props更新。从而实现对.sync语法的模拟")]),t._v(" "),a("p",[t._v("也就是")]),t._v(" "),a("p",[t._v("listeners + setProps ===> 模拟.sync")])])}],!1,null,null,null);e.options.__file="slides.md";s.default=e.exports}}]);